**FAHPのタイプの説明**

ユーザーが求めているのは、現在作成しているFAHPのタイプについての説明です。これは、Changの拡張シンセティック法を用いたFAHPで、三角形のファジィ数、ペアワイズ比較行列を使用し、重みはファジィシンセティック法によって計算します。重みの正規化は平均法で行なわれ、単一の意思決定者による分析です。具体的には、SaatyのAHPをファジィ拡張したもので、三角形スケール、逆数スケールを用い、合成拡張法で重みを決定しています。


思考時間: 12 秒


### いま実装している FAHP のポジションづけ

| 観点          | 本テンプレートが採用                             | 主な別流派                                  |
| ----------- | -------------------------------------- | -------------------------------------- |
| **ファジィ数**   | **三角ファジィ数 (TFN)**<br>（L,M,U の 3 点）     | 四角形 (Trapezoidal) / 区間値 など             |
| **スケール**    | Saaty 1–9 奇数尺度とその逆数                    | 1–5 対称尺度 / 任意連続値                       |
| **重み算出法**   | **Chang の拡張シンセティック（Extent Analysis）法** | Buckley GM 法 / λ-max 法 / 改良シンセティック法 など |
| **デファジィ化**  | **Centroid 法**<br>(L+M+U)/3 をとり最終正規化   | α-cut + COA / 右端点法 など                  |
| **判断者数**    | 単一判断者（行列 1 枚）<br>※複数の場合は行列合成（幾何平均）で拡張可 | グループ意思決定専用アルゴリズム                       |
| **整合性チェック** | なし（必要なら後付け可）                           | ファジィ CR を算出してリジェクト                     |

---

## 1. アルゴリズムの流れ

1. **ペアワイズ入力**

   * 基準行列 $C$（n × n）
   * 各基準ごとに候補行列 $A_k$（m × m）
     セル値は TFN で表現。
2. **行ごとにジオメトリック平均 (GM)**

   $$
   GM_i = \bigl(\prod_{j=1}^n a_{ij}\bigr)^{1/n}
   $$

   を L/M/U 個別に計算。
3. **“合成拡張度”$S_i$ の正規化**

   $$
   \tilde{w}_i = \frac{GM_i}{\sum GM}
   $$

   でファジィ重みベクトルを得る。
4. **デファジィ化（Centroid）**

   $$
   w_i = \frac{L_i+M_i+U_i}{3}
   $$

   をとり、合計 1 になるよう再正規化。
5. **代替案の統合評価**

   $$
   \text{Score}_j = \sum_{i=1}^{n} w_i \, \hat{w}_{ij}
   $$

   （$\hat{w}_{ij}$ は候補側のデファジィ重み）。

---

## 2. なぜ “Chang 法 + TFN” を選んでいるか

* **計算量が軽い** – 行列要素を 3 つの Double 配列に分ければ Excel/VBA でも秒オーダー。
* **逆数性だけ守れば下三角を省略可** – 入力負荷が半減。
* **一度のデファジィ化で済む** – 解析結果を人に説明しやすい。
* **文献・実装例が多い** – 学術論文・業務アプリの双方で使われており、比較検証が楽。

---

## 3. 位置づけ・拡張余地

```
AHP ─┬─ Crisp AHP（従来）
      └─ FAHP
           ├─ TFN + Chang   ←★今回
           ├─ TFN + Buckley GM
           ├─ Trapezoid + λ-max
           └─ Interval AHP
```

* **Consistency Ratio** を導入したい場合

  * デファジィ化した行列に Saaty の CI/CR を適用する簡易法
  * あるいはファジィ固有値に基づく CR を追加実装
* **複数判断者**

  * 判断者 k ごとに行列を入力 → 各セルの TFN を幾何平均して代表行列を生成
* **ANP（ネットワーク）拡張**

  * 依存関係が循環する場合、Supermatrix をファジィ化して乗算

---

### まとめ

作成中のブックは **「三角ファジィ数 × Chang 拡張シンセティック法」** を採用した **スタンダードな単一判断者向け FAHP** テンプレートです。
シンプルかつ汎用なので、整合性チェックやグループ化などの機能を段階的に追加しやすい構造になっています。
