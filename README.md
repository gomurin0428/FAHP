# FAHP 評価ツール  ユーザーガイド

このドキュメントは **FAHPApp**（ファジィ AHP + TOPSIS 評価ツール）の使い方を、エンドユーザー視点でまとめたものです。

> Chang の拡張シンセティック法と三角形ファジィ数 (TFN) を採用し、意思決定の重み付けと候補評価を手早く行えます。

## ユースケース例 — サプライヤ選定

> 複数の取引先候補を、コスト・品質・納期・リスクなど **定量化しづらい複数基準** で評価し、最適なサプライヤを決定したい。
>
> 1. 基準として「コスト / 品質 / 納期 / リスク」を入力。
> 2. 候補として各社名 (例: A社, B社, C社) を入力。
> 3. ペア比較により「品質はコストの 3 倍重要」「A社は B社より納期でやや優れている」などの**専門家判断**を TFN で登録。
> 4. [スコアを計算] をクリックすると、基準重みと各社の総合スコアが算出され、最も高いスコアのサプライヤが自動で分かります。
>
> Excel での集計・重み算出を手作業で行う場合と比較して、**入力と確認だけで瞬時に最適案を得られる** のが本ツールの利点です。

---

## 1. アプリの起動

1. 配布されたフォルダー内にある `FAHPApp.exe` をダブルクリックします。
2. 起動後、以下のようなメインウィンドウが表示されます。

```
╔══════════════════════════════════════════════════════╗
║ ① 基準入力      | ② 候補入力                       ║
║────────────────┼──────────────────────────╣
║ ③ ペア比較を生成 ボタン                             ║
║────────────────────────────────────────────╣
║ ④ 基準間比較行列                                     ║
║────────────────────────────────────────────╣
║ ⑤ 候補比較タブ                                      ║
║────────────────────────────────────────────╣
║ ⑥ スコアを計算 ボタン                                ║
║────────────────────────────────────────────╣
║ ⑦ 基準の重み  | ⑧ 候補スコア                       ║
╚══════════════════════════════════════════════════════╝
```

---

## 2. 基本操作フロー

### STEP 1 ─ 基準を入力する

1. 左上「① 基準入力」テキストボックスに、評価基準を **1 行に 1 つ** ずつ入力します。
2. 例）
   ```
   コスト
   品質
   納期
   ```

### STEP 2 ─ 候補（代替案）を入力する

同様に「② 候補入力」に候補名を **1 行に 1 つ** 入力します。

```
A社
B社
C社
```

### STEP 3 ─ ペア比較行列を生成する

「③ ペア比較を生成」ボタンを押すと、入力した基準・候補の組み合わせに対応する空の行列が自動生成されます。

* ④ 基準間比較行列 … 基準同士を比較
* ⑤ 候補比較タブ … 各基準ごとに候補同士を比較

### STEP 4 ─ 基準間のペア比較を入力する

1. 行列の **上三角セル** をダブルクリックすると「ファジィ数の入力」ダイアログが開きます。
2. ダイアログで以下を設定し、OK を押します。
   * 代表値 … Saaty 1–9 スケール（奇数値）
   * 信頼度 … ±スプレッド (0 = 確信、0.75 = 幅広い不確実性)
3. セルには `(l,m,u)` 形式で登録され、対称セルは逆数が自動計算されます。

> ヒント: 代表値 5 は「同等」、7 は「強い」、9 は「極めて強い」優位を意味します。

### STEP 5 ─ 候補間のペア比較を入力する

* ⑤ のタブを切り替え、各基準について STEP 4 と同じ手順で候補を比較します。

### STEP 6 ─ スコア計算

すべての比較が終わったら「⑥ スコアを計算」ボタンをクリックします。

* ⑦ 基準の重み: 各基準の重みと一貫性比率 (CR) が表示されます。
* ⑧ 候補スコア: 各候補の相対近さ係数 (0〜1)。値が大きいほど優れています。

> CR (Consistency Ratio) が 0.1 を超える場合、入力した比較に一貫性の問題がある可能性があります。再度比較値を見直してください。

### STEP 7 ─ 結果のコピー

表内の任意セルを選択して `Ctrl + A` → `Ctrl + C` で、タブ区切りテキストをクリップボードにコピーできます。Excel 等に貼り付けてレポートに活用してください。

---

## 3. よくある質問 (FAQ)

| 質問 | 回答 |
| ---- | ---- |
| スケールの偶数値 (2,4,6,8) は使えますか? | UI からは直接選べませんが、代表値 3 と 5 の中間程度を表すには信頼度を上げて幅を持たせてください。 |
| サブ基準やネットワーク型 (ANP) には対応していますか? | 現行バージョンは階層 (AHP) のみです。今後のアップデートで検討中です。 |
| 入力内容を保存できますか? | 申し訳ありません、現在はセッション保存に対応していません。必要に応じてスクリーンショットやコピーで記録してください。 |

---

## 4. トラブルシューティング

| 症状 | 解決策 |
| ---- | ---- |
| ボタンが押せない (グレーアウト) | 基準と候補が 1 行以上入力されているか確認してください。 |
| セル編集ができない | 行列の下三角や対角セルは編集不可です。上三角セルのみ入力してください。 |
| CR が高すぎる | 比較値を再検討し、極端な値や矛盾がないか確認してください。 |

---

## 付録 A. 開発者向けビルド手順 (スキップ可)

開発者やカスタマイズを行う方のみ参照してください。

```powershell
# .NET 8 SDK が入っている環境で
> dotnet run --project FAHPApp
```

Visual Studio で開く場合は `FAHP.sln` をロードし、スタートアップを **FAHPApp** に設定すればビルド・実行できます。

---

ご不明な点やバグ報告は Issue へお気軽にご連絡ください 🙌 